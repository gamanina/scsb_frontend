<!--[if IE ]><![endif]-->
<!doctype html>
<!--[if IE 8 ]> <html class="no-js lt-ie9 ie8" lang="zh-TW"> <![endif]-->
<!--[if IE 9 ]> <html class="no-js lt-ie10 ie9" lang="zh-TW"> <![endif]-->
<!--[if (gte IE 10)|!(IE)]><!-->
<html class="no-js" lang="zh-TW">
<!--<![endif]-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <!-- <meta http-equiv="X-UA-Compatible"content="IE=EmulateIE11"> -->
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
    <meta http-equiv="content-language" content="zh-tw">
    <meta name="title" content="上海商業儲蓄銀行｜處處為您著想">
    <meta name="description" content="上海商業儲蓄銀行，秉持「處處為您著想」的服務理念，提供最親切、便捷的多元金融服務，包含企業金融、個人金融、台外幣存匯、財富管理、信用卡等多項服務。">
    <meta name="Keywords" content="存款業務、放款業務、外匯業務、信託業務、國際金融服務及諮詢、應收帳款承購業務、外匯保證金交易、短期票劵、保管箱、代理業務、網路金流服務、代理基金銷售">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.scsb.com.tw/content/dep/index.jsp">
    <meta property="og:image" content="https://www.scsb.com.tw/newscsbweb/content/images/card_img/share/FB.jpg">
    <meta property="og:description" content="上海商業儲蓄銀行，秉持「處處為您著想」的服務理念，提供最親切、便捷的多元金融服務，包含企業金融、個人金融、台外幣存匯、財富管理、信用卡等多項服務。">
    <meta property="og:title" content="上海商業儲蓄銀行｜處處為您著想">
    <title>上海商業儲蓄銀行</title>
    <link rel="image_src" href="https://www.scsb.com.tw/newscsbweb/content/images/card_img/share/FB.jpg">
    <link href="favicon.ico" rel="shortcut icon">

    <link rel="stylesheet" href="/styles/all.css">

    

    
</head>

<body id="activeCont"  data-nav-active-04>
    

    <!--========== HEADER ==============-->
    <header class="header fixed-top">
        <button class="js-toggle-left-slidebar hamburger d-block d-lg-none" type="button"></button>
        <div class="header-wrap" include-html="/common/template_header.html"></div>
    </header>
    <!--========== END Header ==========-->

    <!--========== Loading =============-->
    <div class="overlayMask _open">
        <div class="loader">
            <!-- 如果要顯示無進度條的豆豆，把這段取消註解 -->
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <!-- 如果要顯示無進度條的豆豆，把這段取消註解 -->
        </div>
    </div>
    <!--========== END Loading =========-->

    <!--========== Content =============-->
    <div canvas="container">
        <div class="mainWrap">
            <div class="container-fluid">
                <div class="middleWrap fixed-1200">
                    <div class="row">
                        <div class="col-3 leftCol d-none d-lg-block">
                            <!-- 內頁左側選單 -->
                            <div class="leftCol_menu" include-html="/common/card_left_menu.html"></div>
                        </div>
                        <div class="col-12 col-lg-9 rightCol">
                            <ol class="breadcrumb d-none d-lg-flex" aria-label="麵包屑" data-menu-indexer data-ly-a="A04" data-ly-b="B01" data-ly-c="C01">
                                <li class="accesskey"><a accesskey="C" href="sitemap.jsp" id="accesskey-c" title="中央主內容區塊">:::</a></li>
                                <li class="breadcrumb-item"><a href="https://www.scsb.com.tw/" target="_blank" title="開新視窗-上海商業銀行首頁"><span class="icon-home2"></span></a></li>
                                <li class="breadcrumb-item"><a href="#!">信用卡</a></li>
                                <li class="breadcrumb-item"><a href="#!">刷卡優惠</a></li>
                                <li class="breadcrumb-item active">熱門活動</li>
                            </ol>
                            <div class="inner-kv">
                                <div class="inner-kv-wrap">
                                    <div class="inner-kv-img">
                                        <div class="sharebar d-flex justify-content-end">
                                            <div class="shareNav d-flex align-items-center">
                                                <div class="item">分享：</div>
                                                <div class="item"><a href="javascript:void(0);" class="fb" title="Facebook分享" onclick="shareThisPage('fb')"><img src="/images/fb.svg" class="img-fluid" alt="Facebook分享"></a></div>
                                                <div class="item"><a href="javascript:void(0);" class="line" title="LINE分享" onclick="shareThisPage('line')"><img src="/images/line.svg" class="img-fluid" alt="Line分享"></a></div>
                                                <div class="item d-none d-lg-block"><a href="javascript:void(0);" class="favorite" title="加入收藏"><span>收藏</span></a></div>
                                                <div class="item d-none"><a href="javascript:void(0);" class="favorite-mb" title="加入收藏"><span>收藏</span></a></div>
                                            </div>
                                        </div>
                                        <div class="inner-mask announceKv" style="background: url(/images/card_img/inner_kv/dep08.jpg) no-repeat right center/cover;">
                                            <img on-image-load src="/images/share/inner-kv-mask-1024.png" class="img-fluid" alt="*">
                                        </div>
                                    </div>
                                    <div class="inner-kv-slogan d-flex align-items-sm-center">
                                        <div class="inner-kv-item">
                                            <div class="title h2">熱門活動</div>
                                            <div class="wording"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mainBox">
                                <div class="category_select">
                                    <div class="form_wrap">
                                        <div class="form-group form-row align-items-center mb-0">
                                            <div class="col-12 col-lg-auto pb-2 pb-lg-0">
                                                <span class="labeltitle">請選擇熱門活動分類</span>
                                            </div>
                                            <div class="col-12 col-lg-4">
                                                <select class="custom-select" id="downloadTypeList">
                                                    <option value="">全部</option>
                                                    <option value="bonus" th:selected="${category=='bonus'}">紅利點數</option>
                                                    <option value="travel" th:selected="${category=='travel'}">旅遊活動</option>
                                                    <option value="shopping" th:selected="${category=='shopping'}">網購活動</option>
                                                    <option value="loan" th:selected="${category=='loan'}">預借現金</option>
                                                    <option value="installment" th:selected="${category=='installment'}">分期付款</option>
                                                    <option value="mobilepay" th:selected="${category=='mobilepay'}">行動支付</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="event-all">
                                <th:block th:if="${detailList.empty}">
                                	<span>此分類查無資料</span>
                                </th:block>
                                <th:block th:unless="${detailList.empty}">
                               		<div class="row discount_wrap" id="downloadTypeListTarget">
                               			<div th:each="event : ${detailList}" class="col-md-6" th:attr="data-type-tag=${event.category}">
                               				<div class="card">
                               					<div th:class="'distag ' + ${event.category}" th:text="${event.categoryName}">紅利點數</div>
                                               	<img on-image-load th:src="${event.image}" th:alt="${event.title}" class="img-fluid w-100">
                                               	<a th:href="'/card/hotPage/' + ${event.id}" class="stretched-link" th:title="${event.title}"></a>
                                               	<div class="card-overlay">
                                                    <div class="date" th:text="${#dates.format(event.onTime, 'yyyy/MM/dd')} + '~' + ${#dates.format(event.offTime, 'yyyy/MM/dd')}">2021/01/01~2021/12/31</div>
                                                    <div class="main_title JQellipsis" th:text="${event.title}">安心看電影，刷上海銀行卡線上訂票即享免排隊先選位</div>
                                                    <div class="sub_title" th:text="${#strings.abbreviate(event.content, 27)}">入場前量體溫和雙手消毒安心看電影～刷上海銀行卡行...</div>
                                                    <div class="more">了解詳情</div>
                                               	</div>
                               				</div>
                               			</div>
                               		</div>
                                	
									<!-- Pagination -->
                                    <div class="paginationWrap">
                                        <input type="hidden" class="total_page" th:value="${totalPage}"/>
                                   		<input type="hidden" class="page" th:value="${page}"/>
                                        <ul class="pagination justify-content-center" id="pagenav">
                                        </ul>
                                    </div>
									<!--  END Pagination -->
                                </th:block>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--========== 信用卡分期注意事項 ==========-->
        <div class="loanNotice" include-html="/common/template_creditcard.html"></div>
        <!--========== Footer ==========-->
        <footer class="footer" include-html="/common/template_footer.html"></footer>
        <!--========== END Footer ======-->
    </div>
    <!-- The Modal -->
    <div class="modal fade scsbModal" id="myModal">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
    
                <!-- Modal Header -->
                <div class="modal-header border-0 pb-0">
                    <!-- <h4 class="modal-title">Mobile Phone</h4> -->
                    <button type="button" class="close" data-dismiss="modal"><img src="/images/close.svg" class="img-fluid" alt="關閉視窗"></button>
                </div>
    
                <!-- Modal body -->
                <div class="modal-body text-center">
                    <div class="titleBlk_a h6 bold mb-3">掃描QR Code下載</div>
                    <p><img src="/images/u3005.jpg" class="img-fluid" alt="掃描 台灣PAY 示意"></p>
                </div>
    
            </div>
        </div>
    </div>
    <!--========== END Content =========-->

    <!--========== Mobile Menu =========-->
    <div off-canvas="slidebar-1 left overlay" class="sidemenuWrap" include-html="/common/template_mobile_menu.html"></div>
    <!--========== END Mobile Menu =====-->

    <!--========== Scroll Top ==========-->
    <div class="js-back-to-top back-to-top" include-html="/common/back-to-top.html"></div>
    <!--========== END Scroll Top ======-->

    <script src="/scripts/jquery.min.js"></script>
    <script src="/scripts/bootstrap.bundle.min.js"></script>
    <script src="/scripts/bootstrap-toolkit.min.js"></script>
    <script src="/scripts/jquery.matchHeight-min.js"></script>
    <script src="/scripts/animate.js"></script>
    <script src="/scripts/includeExternalHtml.js"></script>
    <script src="/scripts/swiper.min.js"></script>
    <script src="/scripts/slidebars.js"></script>
    <script src="/scripts/loadingProgress.js"></script>
    <script src="/scripts/picturefill.min.js"></script>
    <script src="/scripts/jquery.back-to-top.js"></script>
    <script src="/scripts/responsive-paginate.js"></script>
    <script src="/scripts/main.js"></script>
    <script>
    	window.onload = new Initial().init();
    	
    	function Initial() {
    		let locking = false;// 下拉選單加鎖防止頻繁操作
    		const maxPageShowCount = isMobileDevice() ? 3 : 10;// 每次能選擇的最大頁數(行動版3,電腦版10)
    		
    		function isMobileDevice() {
    		    const mobileDevice = ['Android', 'webOS', 'iPhone', 'iPad', 'iPod', 'BlackBerry', 'Windows Phone']
    		    let isMobileDevice = mobileDevice.some(e => navigator.userAgent.match(e))
    		    return isMobileDevice
    		}
    		
    		let actions = {
    				/**
    				** 取得總頁數
    				** @return 總頁數
    				*/
    				getTotalPage: function() {
    					let totalPage = $('div.paginationWrap input.total_page').val();
    					return totalPage ? parseInt(totalPage) : 0;
    				},
    				/**
    				** 取得當前頁數
    				** @return 當前頁數
    				*/
    				getPage: function() {
    					let page = $('div.paginationWrap input.page').val();
    					return page ? parseInt(page) : 0;
    				},
    				/**
    				** 頁面渲染
    				** @param page 當前頁數
    				** @param finalCallBack 回呼function
    				*/
    				renderPage: function(page, finalCallBack) {
    					if (page < 1 || (actions.getTotalPage() > 0 && page > actions.getTotalPage())) {
    						// 如果有回呼function則執行
							if (typeof finalCallBack == 'function') {
								finalCallBack();
							}
    						return;
    					}
        				$.ajax({
        					timeout: 3000,// 送出請求3秒後沒收到回應拋錯誤訊息
        					url: '/card/hotList/' + $('#downloadTypeList').val() + '?page=' + page,
        					type: 'GET',
        					success: function (result) {
        						// 將後端渲染後的頁面取回替代目前的event-all區塊
        						$('#event-all').html(
        								$(result).find('#event-all').html()
        								);
        						// 分頁渲染
        						actions.genPageNav();
        						// 將頁面捲到最上方
        						$('div.js-back-to-top').click();
        					},
        					error: function (error, textStatus, errorThrown) {
        						alert('頁面加載發生錯誤')
        					},
        					complete: function(complete, status) {
        						// 如果有回呼function則執行
    							if (typeof finalCallBack == 'function') {
    								finalCallBack();
    							}
        					}
        				});
    				},
    				/**
    				** 渲染分頁物件
    				*/
    				genPageNav: function() {
    					const totalPage = actions.getTotalPage();// 取得最總頁數
    					if (totalPage > 0) {// 如果總頁數大於0才渲染
    						// 取得當前頁數
    						const page = actions.getPage();
    						// 清空頁面選擇物件
        					$('#pagenav').empty();
        					// 分頁物件
        					const pageAry = [];
        					// 定義從第幾頁開始渲染
        					const startPage = page % maxPageShowCount == 0 ? (parseInt(page / maxPageShowCount) * maxPageShowCount) - maxPageShowCount + 1  : (parseInt(page / maxPageShowCount) * maxPageShowCount + 1);
        					// 已渲染的物件數量
        					let alreadyGen = 0;
        					// 當前頁數在第幾個物件
        					const actPage = page % maxPageShowCount + parseInt(page / maxPageShowCount) * maxPageShowCount;
        					for (var i = startPage; i <= totalPage && alreadyGen < maxPageShowCount; i++) {
        						alreadyGen++;// 累加渲染物件數
        						// 定義a tag jquery物件
        						const $a = $('<a href="javascript:void(0);" class="page-link">').text(i);
        						if (actPage == i) {// 如果當前物件數等於當前頁數所在位置
        							$a.addClass('act');// 加入紅色背景代表當前頁數
									pageAry.push($('<li class="page-item disabled">').append($a));// 設定為不可選
        						} else {
        							// 如果非當前頁面綁定click事件供直接跳轉
        							$a.click(function(e) {
            							actions.renderPage($(this).text());
            						})
									pageAry.push($('<li class="page-item">').append($a));
        						}
        					}
        					// 從左箭頭開始渲染到右箭頭，最後顯示當前頁數 / 總頁數
        					$('#pagenav').append(
        							$('<li class="page-item"><a href="javascript:void(0);" class="button-prev"></a></li>'),// 左箭頭
        							pageAry,// 頁數物件
        							$('<li class="page-item"><a href="javascript:void(0);" class="button-next"></a></li>'),// 右箭頭
        							$('<li class="page-item disabled"><a href="javascript:void(0);" class="page-link">' + actions.getPage() + '/' + actions.getTotalPage() + '</a></li>'));// 當前頁數 / 總頁數
        					
        					// 綁定前頁、後頁click事件
        					$('#pagenav a.button-prev').click(function(e) {
	    						e.preventDefault();
	    						e.stopPropagation();
        						actions.renderPage(actions.getPage() - 1);
        					});
        					$('#pagenav a.button-next').click(function(e) {
	    						e.preventDefault();
	    						e.stopPropagation();
        						actions.renderPage(actions.getPage() + 1);
        					});
    					}
    				}
    		}
    		
    		return {
    			init: function() {
    				$('#downloadTypeList').change(function(e) {
    					if (locking) {// 如果已經選過並且還沒得到回應直接忽略
    						return;
    					}
    					const $this = $(this);
    					$this.attr('disabled', true);// 禁用下拉
    					locking = true;// 鎖定
    					actions.renderPage.call(this, 1, function() {// 回呼function, 會在ajax回應後執行
		    						$this.attr('disabled', false);// 解除禁用
		    						locking = false;// 解除鎖定
    							});
    				});
    				// 頁面完成loading後渲染分頁物件
    				actions.genPageNav();
    			}
    		}
    	}
    	
    </script>
    
</body>

</html>