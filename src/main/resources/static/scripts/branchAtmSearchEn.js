var onChangeCity,onChangeDist,choCity,choDist,allBranchJson,branchCityLocation=[],initBranchSource=function(){console.log("initBranchSource");fetch("./EN_branch_data.json").then(function(t){return t.json()}).then(function(t){console.log("parsed json",t),getCities(allBranchJson=t),renderCity(branchCityLocation),renderBranchContent(allBranchJson)})},getCities=function(t){for(var n in t){var o=!1;for(var i in branchCityLocation)if(console.log(t[n][0]),branchCityLocation[i].city==t[n][0]){for(var e in _distIn=!(o=!0),branchCityLocation[i].dist)branchCityLocation[i].dist[e]==t[n][1]&&(_distIn=!0);_distIn||branchCityLocation[i].dist.push(t[n][1])}o||branchCityLocation.push({city:t[n][0],dist:[t[n][1]]})}console.log(branchCityLocation)},renderCity=function(t){var n=Mustache.render('<option value="" selected="selected">Select city</option>{{#cityOpt}}<option value="{{city}}">{{city}}</option>{{/cityOpt}}',{cityOpt:t,city:function(){return this[0]}});document.getElementById("cityLoc").innerHTML=n};onChangeCity=function(){var t;for(var n in choCity=document.getElementById("cityLoc").value,branchCityLocation)branchCityLocation[n].city==choCity&&(t=branchCityLocation[n].dist);var o=Mustache.render('<option value="" selected="selected">Select location</option>{{#distOpt}}<option value="{{.}}">{{.}}</option>{{/distOpt}}',{distOpt:t});document.getElementById("distLoc").innerHTML=o},onChangeDist=function(){choDist=document.getElementById("distLoc").value;var t=[];for(var n in allBranchJson)console.log(choCity),console.log(allBranchJson[n][0]),console.log(choDist),console.log(allBranchJson[n][1]),allBranchJson[n][0]==choCity&&allBranchJson[n][1]==choDist&&t.push(allBranchJson[n]);renderBranchContent(t)};var renderBranchContent=function(t){var n=document.getElementById("branch_template").innerHTML,o=0,i=Mustache.render(n,{branchBlk:t,branchTotal:function(){return t.length},branch_name:function(){return this[2]},branch_addr:function(){return this[3]},branch_map:function(){return this[4]},branch_tel_show:function(){return""!=this[5]},branch_tel:function(){return this[5]},branch_fax_show:function(){return""!=this[6]},branch_fax:function(){return this[6]},branch_code_show:function(){return"–"!=this[7]},branch_code:function(){return this[7]},branch_open:function(){return this[8]},branch_safe:function(){return"v"==this[9]},branch_vip:function(){return"v"==this[10]},branch_bot:function(){return"v"==this[11]},branch_friend:function(){return"v"==this[12]},index:function(){return o},showHr:function(){return++o%2==0}});document.getElementById("branch_target").innerHTML=i,document.getElementById("sumBranch").innerHTML=o};$(function(){initBranchSource()});var onChangeAtmCity,onChangeAtmDist,choAtmCity,choAtmDist,allAtmJson,atmCityLocation=[],initAtmSource=function(){console.log("initAtmSource");fetch("./EN_a_atm_data.json").then(function(t){return t.json()}).then(function(t){console.log("parsed json",t),getAtmCities(allAtmJson=t),renderAtmCity(atmCityLocation),renderAtmContent(allAtmJson)})},getAtmCities=function(t){for(var n in t){var o=!1;for(var i in atmCityLocation)if(console.log(t[n][0]),atmCityLocation[i].city==t[n][0]){for(var e in _distIn=!(o=!0),atmCityLocation[i].dist)atmCityLocation[i].dist[e]==t[n][1]&&(_distIn=!0);_distIn||atmCityLocation[i].dist.push(t[n][1])}o||atmCityLocation.push({city:t[n][0],dist:[t[n][1]]})}console.log(atmCityLocation)},renderAtmCity=function(t){var n=Mustache.render('<option value="" selected="selected">請選擇縣市</option>{{#cityOpt}}<option value="{{city}}">{{city}}</option>{{/cityOpt}}',{cityOpt:t,city:function(){return this[0]}});document.getElementById("cityAtmLoc").innerHTML=n};onChangeAtmCity=function(){var t;for(var n in choAtmCity=document.getElementById("cityAtmLoc").value,atmCityLocation)atmCityLocation[n].city==choAtmCity&&(t=atmCityLocation[n].dist);var o=Mustache.render('<option value="" selected="selected">請選擇區域</option>{{#distOpt}}<option value="{{.}}">{{.}}</option>{{/distOpt}}',{distOpt:t});document.getElementById("distAtmLoc").innerHTML=o},onChangeAtmDist=function(){choAtmDist=document.getElementById("distAtmLoc").value;var t=[];for(var n in allAtmJson)console.log(choAtmCity),console.log(allAtmJson[n][0]),console.log(choAtmDist),console.log(allAtmJson[n][1]),allAtmJson[n][0]==choAtmCity&&allAtmJson[n][1]==choAtmDist&&t.push(allAtmJson[n]);renderAtmContent(t)};var renderAtmContent=function(t){var n=document.getElementById("atm_template").innerHTML,o=0,i=Mustache.render(n,{atmBlk:t,atmTotal:function(){return t.length},atm_name:function(){return this[2]},atm_addr:function(){return this[3]},atm_map:function(){return this[4]},atm_open:function(){return"v"==this[5]},atm_atm:function(){return"v"==this[6]},atm_bankbook:function(){return"v"==this[7]},atm_deposit:function(){return"v"==this[8]},atm_coin:function(){return"v"==this[9]},atm_foreign:function(){return"v"==this[10]},atm_pay:function(){return"v"==this[11]},index:function(){return o},showHr:function(){return++o%2==0}});document.getElementById("atm_target").innerHTML=i,document.getElementById("sumAtm").innerHTML=o};$(function(){initAtmSource()});